!function(f){"use strict";window.dotinsights=window.dotinsights||{},dotinsights.Projects=dotinsights.Projects||{},dotinsights.FilteredProjects=dotinsights.FilteredProjects||{},dotinsights.Query=dotinsights.Query||{itemsPerPage:50,maxNumPages:1,page:1,foundItems:0},dotinsights.Pagination=dotinsights.Pagination||{},dotinsights.FilteredProjects=dotinsights.FilteredProjects||{},window.innerWidth<561?dotinsights.Pagination.midSize=2:dotinsights.Pagination.midSize=3,window.innerWidth<768?dotinsights.Query.itemsPerPage=10:dotinsights.Query.itemsPerPage=50;var p=window.dotinsights.Helpers,s=f("#project-form-filter"),t=s.find(".search-submit"),e=null,u=f("#most-loved-projects-table tbody"),r=f("#most-loved-projects-pagination");function o(t=!1){for(var e=(dotinsights.Query.page-1)*dotinsights.Query.itemsPerPage+1,i="",s=(s=e+dotinsights.Query.itemsPerPage)>dotinsights.Query.foundItems?dotinsights.Query.foundItems+1:s,o=e;o<s;o++){var n=dotinsights.FilteredProjects[o-1],r="row-project",a=n.rank<=3,l='<span class="rank-number">'+n.rank+"</span>",l=a?'<svg><use xlink:href="#symbol-crown"></use></svg>'+l:l,a=(r+=a?" row-project-highlight":"","project-layer"),a=(a+=n.layer?" project-layer-color--"+p.sanitizeKey(n.layer):"","string"==typeof n.layer?'<span class="'+a+'">'+n.layer+"</span>":'<span class="text-placeholder">--</span>'),d=""!==n.token?n.token:'<span class="text-placeholder">--</span>',c='<input type="checkbox" readonly disabled class="project-is-native"'+(!0===n.native?" checked":"")+" />",g="./assets/images/projects/"+n.project_slug+".png",h="";n.categories.map(function(t,e){h=(h+=0<e?", ":"")+'<span class="project-cat-color--'+t.slug+'">'+t.name+"</span>"}),h='<p class="project-category">'+h+"</p>",i=(i=(i=(i=(i=(i=(i+='<tr class="'+r+'">')+('<td class="col-project-info"><a href="'+n.website+'" target="_blank" rel="nofollow" class="project-info"><div class="project-rank">'+l+'</div><div class="project-thumbnail"><img src="'+g+'" alt="'+n.project+'" width="80" height="80"/></div><div class="project-details"><h3 class="project-name">'+n.project+"</h3>"+h+"</div></a></td>")+('<td class="col-project-layer">'+a+"</td>"))+('<td class="col-project-token"><span class="project-token">'+d+"</span></td>")+('<td class="col-project-native">'+c+"</td>"))+('<td class="col-project-github">'+m(n)+"</td>"))+('<td class="col-project-twitter">'+v(n)+"</td>"))+('<td class="col-mobile-project-info">'+'<div class="project-info-line"><div class="label">Native: </div>'+'<div class="value">'+c+'</div></div><div class="project-info-line"><div class="label">Layer: </div><div class="value">'+a+'</div></div><div class="project-info-line"><div class="label">Token: </div><div class="value">'+d+'</div></div><div class="project-info-line"><div class="label">Github: </div><div class="value">'+m(r=n)+'</div></div><div class="project-info-line"><div class="label">Twitter: </div><div class="value">'+v(r)+"</div></div></td>"))+('<td class="col-project-votes">'+(l=n,c=g=void 0,g=dotinsights.VotedProjects.includes(l.project_id),c="button btn-vote",c+=g?" unvote-this":" vote-this",'<a href="#" data-project-id="')+l.project_id+'" class="'+c+'"><svg class="button-icon"><use xlink:href="#symbol-ph-heart-straight"></use></svg><span class="button-text">'+dotinsights.NumberUtil.formatWithCommas(l.vote_count)+"</span></a></td>")+"</tr>"}t?u.append(i):u.html(i)}function n(){var t="",e=dotinsights.Query.maxNumPages;if(1<e){for(var i=dotinsights.Query.page,s=[i],o=1,n=i-1;0<n&&(s.unshift(n),o!==dotinsights.Pagination.midSize);n--)o++;for(o=1,n=i+1;n<=e&&(s.push(n),o!==dotinsights.Pagination.midSize);n++)o++;t+="<ul>",1<i&&(t+='<li><a href="#" class="page-prev"  data-page="'+(i-1)+'"><svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" fill="#000000" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><polyline points="56 48 136 128 56 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline><polyline points="136 48 216 128 136 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline></svg></a></li>');for(n=0;n<s.length;n++)t=(t+="<li>")+(s[n]===i?'<span class="page-numbers current">'+s[n]+"</a>":'<a href="#" class="page-numbers" data-page="'+s[n]+'">'+s[n]+"</a>")+"</li>";i<e&&(t+='<li><a href="#" class="page-next" data-page="'+(i+1)+'"><svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" fill="#000000" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><polyline points="56 48 136 128 56 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline><polyline points="136 48 216 128 136 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline></svg></a></li>'),t+="</ul>"}r.html(t)}function v(t){var e;return t.twitter&&""!==t.twitter&&"N/A"!==t.twitter?(e=(e=t.twitter.replace("https://twitter.com/","@")).replace("https://mobile.twitter.com/","@",e),e=dotinsights.StringUtil.rtrim(e,"/"),'<a href="'+t.twitter+'" target="_blank" class="project-link-twitter text-1-row"><span>'+e+"</span></a>"):'<span class="text-placeholder">--</span>'}function m(t){return t.github&&""!==t.github&&"N/A"!==t.github?'<a href="'+t.github+'" target="_blank" class="project-link-github"><span class="fab fa-github"></span></a>':'<span class="text-placeholder">--</span>'}f(document.body).on("dotinsights/EcosystemMap/Loaded",function(){dotinsights.FilteredProjects=dotinsights.Projects;var v,m,y,t=dotinsights.FilteredProjects.length;function e(){y.empty();var t=y.width(),e=[],i={},s=!1,o=0,n=0,r=1,a=(window.innerWidth<768?r=.5:window.innerWidth<1200&&(r=.8),2115-window.innerWidth);a*=r,a=Math.max(a,700),y.height(a);for(var l=0;l<m;l++){var d=dotinsights.NumberUtil.precisionRoundMod(v[l].r*r,0);v[l].displayR=Math.max(d,40)}for(;e.length<m&&o<1e4;){(i=v[n]).x=dotinsights.NumberUtil.getRandomInt(i.displayR,t-i.displayR),i.y=dotinsights.NumberUtil.getRandomInt(i.displayR,a-i.displayR);for(s=!1,l=0;l<e.length;l++){var c=e[l];if(dotinsights.NumberUtil.dist(i.x,i.y,c.x,c.y)<i.displayR+c.displayR){s=!0;break}}s||(e.push(i),n++),o++}for(var g=["move-slow","move-normal","move-fast"],l=0;l<e.length;l++){var h=e[l],p=h.vote_count||0,u="bubble-project bubble-project--"+h.project_slug,u='<div class="'+((u+=l%2==0?" move-vertical":" move-vertical-reversed")+(" "+g[dotinsights.NumberUtil.getRandomInt(0,3)]))+'">',p=(u=(u+='<img src="./assets/images/projects/'+h.project_slug+'.png" alt="">')+("<h3>"+h.project+'</h3><div class="vote-count"><svg><use xlink:href="#symbol-ph-heart-straight"></use></svg>'+p+"</div>"),f(u+="</div>"));p.css({width:2*h.displayR,height:2*h.displayR,top:h.y-h.displayR,left:h.x-h.displayR}),p.css("--circle-size",2*h.displayR+"px"),y.append(p)}}dotinsights.Query.page=1,dotinsights.Query.foundItems=t,dotinsights.Query.maxNumPages=0<dotinsights.Query.itemsPerPage?Math.ceil(t/dotinsights.Query.itemsPerPage):1,m=(v=[{r:197},{r:144},{r:121},{r:107},{r:102},{r:102},{r:96},{r:88},{r:77},{r:76},{r:76},{r:68},{r:64},{r:60},{r:60},{r:57},{r:57},{r:54},{r:52},{r:49},{r:48},{r:39},{r:38},{r:35},{r:33}]).length,y=f("#bubble-projects"),v=v.map(function(t,e){return{...t,...dotinsights.Projects[e]}}),e(),f(window).on("hresize_one",function(){e()}),o(),n()}),s.on("keyup",".search-field",function(){clearTimeout(e),e=setTimeout(function(){t.addClass("updating-icon"),setTimeout(function(){t.removeClass("updating-icon"),f(document.body).trigger("dotinsights/EcosystemMap/Searching")},300)},700)}),s.on("submit",function(t){return clearTimeout(e),e=setTimeout(function(){f(document.body).trigger("dotinsights/EcosystemMap/Searching")},700),!1}),f(document.body).on("dotinsights/EcosystemMap/Searching",function(t){var e=s.find('input[name="s"]').val(),i=[],e=(""!==e&&i.push({relation:"or",terms:[{key:"project",value:e,operator:"like"},{key:"category",value:e,operator:"like"},{key:"layer",value:e,operator:"like"},{key:"token",value:e,operator:"like"}]}),dotinsights.FilteredProjects=0<i.length?p.filterByRules(i,dotinsights.Projects):dotinsights.Projects,dotinsights.FilteredProjects.length);dotinsights.Query.page=1,dotinsights.Query.foundItems=e,dotinsights.Query.maxNumPages=0<dotinsights.Query.itemsPerPage?Math.ceil(e/dotinsights.Query.itemsPerPage):1,o(),n()}),f(window).on("hresize",function(){window.innerWidth<561?dotinsights.Pagination.midSize=2:dotinsights.Pagination.midSize=3,window.innerWidth<768?dotinsights.Query.itemsPerPage=10:dotinsights.Query.itemsPerPage=50}),r.on("click","a",function(t){t.preventDefault(),dotinsights.Query.page=f(this).data("page");t=u.offset().top-120;f("html, body").animate({scrollTop:t},200),o(),n()})}(jQuery);