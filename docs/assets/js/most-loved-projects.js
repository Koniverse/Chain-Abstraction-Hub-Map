!function(v){"use strict";window.abslayer=window.abslayer||{},abslayer.Projects=abslayer.Projects||{},abslayer.FilteredProjects=abslayer.FilteredProjects||[],abslayer.Query=abslayer.Query||{itemsPerPage:50,maxNumPages:1,page:1,foundItems:0},abslayer.Pagination=abslayer.Pagination||{},window.innerWidth<561?abslayer.Pagination.midSize=2:abslayer.Pagination.midSize=3,window.innerWidth<768?abslayer.Query.itemsPerPage=10:abslayer.Query.itemsPerPage=50;var t,d=window.abslayer.Helpers,r=v("#project-form-filter"),e=r.find(".search-submit"),a=null,y=v("#most-loved-projects-table tbody"),l=v("#most-loved-projects-pagination"),s=(t={},(abslayer.Configs?.projectPriority||[]).forEach((e,a)=>{t[e]=a}),t);function i(e,a){var t=s[e.project_slug]??1/0,r=s[a.project_slug]??1/0;return t!==r?t-r:e.project.localeCompare(a.project)}function o(e=!1){for(var a=(abslayer.Query.page-1)*abslayer.Query.itemsPerPage+1,t="",r=(r=a+abslayer.Query.itemsPerPage)>abslayer.Query.foundItems?abslayer.Query.foundItems+1:r,s=a;s<r;s++){var i=abslayer.FilteredProjects[s-1],l='<span class="rank-number">'+s+"</span>",o="project-layer",o=(o+=i.layer?" project-layer-color--"+d.sanitizeKey(i.layer):"","string"==typeof i.layer?'<span class="'+o+'">'+i.layer+"</span>":'<span class="text-placeholder">--</span>'),n=""!==i.token?i.token:'<span class="text-placeholder">--</span>',c="./assets/images/projects/"+i.project_slug+".png",p="";i.categories.map(function(e,a){p=(p+=0<a?", ":"")+'<span class="project-cat-color--'+e.slug+'">'+e.name+"</span>"}),p='<p class="project-category">'+p+"</p>",t=(t=(t=(t=(t=(t=(t+='<tr class="row-project">')+('<td class="col-project-info"><a href="'+i.website+'" target="_blank" rel="nofollow" class="project-info"><div class="project-rank">'+l+'</div><div class="project-thumbnail"><img src="'+c+'" alt="'+i.project+'" width="80" height="80"/></div><div class="project-details"><h3 class="project-name">'+i.project+"</h3>"+p+"</div></a></td>"))+('<td class="col-project-layer">'+o+"</td>")+('<td class="col-project-token"><span class="project-token">'+n+"</span></td>"))+('<td class="col-project-github">'+b(i)+"</td>"))+('<td class="col-project-twitter">'+u(i)+"</td>"))+('<td class="col-mobile-project-info">'+'<div class="project-info-line"><div class="label">Layer: </div>'+'<div class="value">'+o+'</div></div><div class="project-info-line"><div class="label">Token: </div><div class="value">'+n+'</div></div><div class="project-info-line"><div class="label">Github: </div><div class="value">'+b(l=i)+'</div></div><div class="project-info-line"><div class="label">Twitter: </div><div class="value">'+u(l)+"</div></div></td>"))+('<td class="col-project-votes">'+function(e){var a=abslayer.VotedProjects.includes(e.project_id),t="button btn-vote";t+=a?" unvote-this":" vote-this";return'<a href="#" data-project-id="'+e.project_id+'" class="'+t+'"><svg class="button-icon"><use xlink:href="#symbol-ph-heart-straight"></use></svg><span class="button-text">'+abslayer.NumberUtil.formatWithCommas(0)+"</span></a>"}(i)+"</td>")+"</tr>"}e?y.append(t):y.html(t)}function n(){var e="",a=abslayer.Query.maxNumPages;if(1<a){for(var t=abslayer.Query.page,r=[t],s=1,i=t-1;0<i&&(r.unshift(i),s!==abslayer.Pagination.midSize);i--)s++;for(s=1,i=t+1;i<=a&&(r.push(i),s!==abslayer.Pagination.midSize);i++)s++;e+="<ul>",1<t&&(e+='<li><a href="#" class="page-prev"  data-page="'+(t-1)+'"><svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" fill="#000000" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><polyline points="56 48 136 128 56 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline><polyline points="136 48 216 128 136 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline></svg></a></li>');for(i=0;i<r.length;i++)e=(e+="<li>")+(r[i]===t?'<span class="page-numbers current">'+r[i]+"</a>":'<a href="#" class="page-numbers" data-page="'+r[i]+'">'+r[i]+"</a>")+"</li>";t<a&&(e+='<li><a href="#" class="page-next" data-page="'+(t+1)+'"><svg xmlns="http://www.w3.org/2000/svg" width="192" height="192" fill="#000000" viewBox="0 0 256 256"><rect width="256" height="256" fill="none"></rect><polyline points="56 48 136 128 56 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline><polyline points="136 48 216 128 136 208" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"></polyline></svg></a></li>'),e+="</ul>"}l.html(e)}function u(e){var a;return e.twitter&&""!==e.twitter&&"N/A"!==e.twitter?(a=(a=(a=e.twitter.replace("https://twitter.com/","@")).replace("https://mobile.twitter.com/","@")).replace("https://x.com/","@"),a=abslayer.StringUtil.rtrim(a,"/"),'<a href="'+e.twitter+'" target="_blank" class="project-link-twitter text-1-row"><span>'+a+"</span></a>"):'<span class="text-placeholder">--</span>'}function b(e){return e.github&&""!==e.github&&"N/A"!==e.github?'<a href="'+e.github+'" target="_blank" class="project-link-github"><span class="fab fa-github"></span></a>':'<span class="text-placeholder">--</span>'}abslayer.FilteredProjects.sort(i),v(document.body).on("abslayer/EcosystemMap/Loaded",function(){var g,h,m,e=abslayer.Projects.slice(),e=(e.sort(i),abslayer.FilteredProjects=e,abslayer.FilteredProjects.length);function a(){m.empty();var e=m.width(),a=[],t={},r=!1,s=0,i=0,l=1,o=(window.innerWidth<768?l=.5:window.innerWidth<1200&&(l=.8),2115-window.innerWidth);o*=l,o=Math.max(o,700),m.height(o);for(var n=0;n<h;n++){var c=abslayer.NumberUtil.precisionRoundMod(g[n].r*l,0);g[n].displayR=Math.max(c,40)}for(;a.length<h&&s<1e4;){(t=g[i]).x=abslayer.NumberUtil.getRandomInt(t.displayR,e-t.displayR),t.y=abslayer.NumberUtil.getRandomInt(t.displayR,o-t.displayR);for(r=!1,n=0;n<a.length;n++){var p=a[n];if(abslayer.NumberUtil.dist(t.x,t.y,p.x,p.y)<t.displayR+p.displayR){r=!0;break}}r||(a.push(t),i++),s++}for(var d=["move-slow","move-normal","move-fast"],n=0;n<a.length;n++){var y=a[n],u=y.vote_count||0,b="bubble-project bubble-project--"+y.project_slug,b='<div class="'+((b+=n%2==0?" move-vertical":" move-vertical-reversed")+(" "+d[abslayer.NumberUtil.getRandomInt(0,3)]))+'">',u=(b=(b+='<img src="./assets/images/projects/'+y.project_slug+'.png" alt="">')+("<h3>"+y.project+'</h3><div class="vote-count"><svg><use xlink:href="#symbol-ph-heart-straight"></use></svg>'+u+"</div>"),v(b+="</div>"));u.css({width:2*y.displayR,height:2*y.displayR,top:y.y-y.displayR,left:y.x-y.displayR}),u.css("--circle-size",2*y.displayR+"px"),m.append(u)}}abslayer.Query.page=1,abslayer.Query.foundItems=e,abslayer.Query.maxNumPages=0<abslayer.Query.itemsPerPage?Math.ceil(e/abslayer.Query.itemsPerPage):1,h=(g=[{r:197},{r:144},{r:121},{r:107},{r:102},{r:102},{r:96},{r:88},{r:77},{r:76},{r:76},{r:68},{r:64},{r:60},{r:60},{r:57},{r:57},{r:54},{r:52},{r:49},{r:48},{r:39},{r:38},{r:35},{r:33}]).length,m=v("#bubble-projects"),g=g.map(function(e,a){return{...e,...abslayer.Projects[a]}}),a(),v(window).on("hresize_one",function(){a()}),o(),n()}),r.on("keyup",".search-field",function(){clearTimeout(a),a=setTimeout(function(){e.addClass("updating-icon"),setTimeout(function(){e.removeClass("updating-icon"),v(document.body).trigger("abslayer/EcosystemMap/Searching")},300)},700)}),r.on("submit",function(e){return clearTimeout(a),a=setTimeout(function(){v(document.body).trigger("abslayer/EcosystemMap/Searching")},700),!1}),v(document.body).on("abslayer/EcosystemMap/Searching",function(e){var a=r.find('input[name="s"]').val(),t=[],a=(""!==a&&t.push({relation:"or",terms:[{key:"project",value:a,operator:"like"},{key:"category",value:a,operator:"like"},{key:"layer",value:a,operator:"like"},{key:"token",value:a,operator:"like"}]}),0<t.length?d.filterByRules(t,abslayer.Projects):abslayer.Projects),t=((a=a.slice()).sort(i),abslayer.FilteredProjects=a,abslayer.FilteredProjects.length);abslayer.Query.page=1,abslayer.Query.foundItems=t,abslayer.Query.maxNumPages=0<abslayer.Query.itemsPerPage?Math.ceil(t/abslayer.Query.itemsPerPage):1,o(),n()}),v(window).on("hresize",function(){window.innerWidth<561?abslayer.Pagination.midSize=2:abslayer.Pagination.midSize=3,window.innerWidth<768?abslayer.Query.itemsPerPage=10:abslayer.Query.itemsPerPage=50}),l.on("click","a",function(e){e.preventDefault(),abslayer.Query.page=v(this).data("page");e=y.offset().top-120;v("html, body").animate({scrollTop:e},200),o(),n()})}(jQuery);