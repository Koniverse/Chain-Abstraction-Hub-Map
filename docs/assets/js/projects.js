!function(d){"use strict";window.abslayer=window.abslayer||{},abslayer.Projects=abslayer.Projects||{},abslayer.Query=abslayer.Query||{itemsPerPage:3,maxNumPages:1,page:1,foundItems:0},abslayer.FilteredProjects=abslayer.FilteredProjects||[];var l=window.abslayer.Helpers,t=0,r=d(window),c={key_management:10,account_abstraction:20,wallet:30,policies:40,intent:50,tooling:60,mempools:70,sequencing:80,auction:90,order_flow:100,private_computation:110,routing:120,last_look:130,inventory:140,oracle:150,bridge:160,pre_confirmation:170,data_availability:180,finality:190,liquidity:200,proofs:210,execution:220,application_layer:230,uncategorized:9999},s=d("#project-form-filter"),e=s.find(".search-submit"),a=null,p=d("#project-categories-list"),u=d("#btn-load-more-projects");async function o(i,n=void 0){return new Promise(e=>{var a=[];if(0<i.length){var t,r=l.groupByKeys(i,"category_slugs");for(t in r=n?{[n]:r[n]}:r){var s=r[t],s=(s.sort(function(e,a){return e.project.localeCompare(a.project)}),{key:t,name:"uncategorized"===t?"Uncategorized":function(a,e){var t="Uncategorized";return e.split(",").map(e=>e.trim()).forEach(e=>{l.sanitizeKey(e)===a&&(t=e)}),t}(t,r[t][0].category),projects:s});s.order=c.hasOwnProperty(t)?c[t]:999,a.push(s)}}var o=(a=abslayer.ArrayUtil.sortByKey(a,"order","ASC")).length;abslayer.FilteredProjects=a,abslayer.Query.page=1,abslayer.Query.foundItems=o,abslayer.Query.maxNumPages=0<abslayer.Query.itemsPerPage?Math.ceil(o/abslayer.Query.itemsPerPage):1,1<abslayer.Query.maxNumPages?u.show():u.hide(),e("resolved")})}function i(e=!1){for(var a=(abslayer.Query.page-1)*abslayer.Query.itemsPerPage+1,t="",r=(r=a+abslayer.Query.itemsPerPage)>abslayer.Query.foundItems?abslayer.Query.foundItems+1:r,s=a;s<r;s++){var o=abslayer.FilteredProjects[s-1],i=o.projects,n=i.length,l="tm-animation fade-in-up cat-item cat-"+o.key,c=""!==o.name?o.name:"Others";t=t+('<div class="'+l+'"><h3 class="'+("project-category-name project-cat-color--"+o.key)+'">'+c+'<span class="count">'+n+"</span></h3>")+'<div class="projects-grid grid-modern" style="--grid-columns-desktop: 8; --grid-gutter-desktop: 20;--grid-columns-laptop: 7; --grid-columns-tablet-extra: 6; --grid-columns-tablet: 4; --grid-columns-mobile-extra: 3; --grid-columns-mobile: 2;">';for(var u=0;u<n;u++)var y=i[u],m="../assets/images/projects/"+y.project_slug+".png",t=(t=(t+='<a href="'+y.website+'" target="_blank" rel="nofollow" class="grid-item project-item">')+('<div class="project-thumbnail"><img src="'+m+'" alt="'+y.project+'" width="80" height="80"/></div>'))+('<div class="project-info"><h3 class="project-name">'+y.project+"</h3></div>")+"</a>";t+="</div></div>"}e?p.append(t):p.html(t),p.find(".tm-animation").waypoint(function(){var e=this.element||d(this);d(e).addClass("animate")},{offset:"100%"})}d(document.body).on("abslayer/EcosystemMap/Loaded",function(){!async function(){await o(abslayer.Projects),function(){for(var e=abslayer.Projects.length,a=d("#project-categories-filter"),t='<a href="#" data-cat="" class="current filter-item filter-all"><span class="filter-name">All projects</span><span class="filter-count">'+e+"</span></a>",r=0;r<abslayer.FilteredProjects.length;r++){var s=abslayer.FilteredProjects[r],o=s.projects,i="filter-item project-cat-color--"+s.key;t+='<a href="#" data-cat="'+s.key+'" class="'+i+'"><span class="filter-name">'+s.name+'</span><span class="filter-count">'+o.length+"</span></a>"}a.html(t)}(),i()}()}),s.on("keyup",".search-field",function(){clearTimeout(a),a=setTimeout(function(){e.addClass("updating-icon"),setTimeout(function(){e.removeClass("updating-icon"),d(document.body).trigger("abslayer/EcosystemMap/Searching")},300)},700)}),s.on("submit",function(e){return clearTimeout(a),a=setTimeout(function(){d(document.body).trigger("abslayer/EcosystemMap/Searching")},700),!1}),d(document.body).on("abslayer/EcosystemMap/Searching",function(){!async function(){var e=s.find('input[name="s"]').val(),a=s.find('input[name="cat"]').val(),t=[],r=[];""!==e&&r.push({key:"project",value:e,operator:"like"});""!==a&&r.push({key:"category_slugs",value:a,operator:"in"});0<r.length&&t.push({relation:"and",terms:r});e=0<t.length?l.filterByRules(t,abslayer.Projects):abslayer.Projects;""!==a?await o(e,a):await o(e);i()}()}),d(document.body).on("click",".filter-item",function(e){e.preventDefault();var a,e=d(this);e.hasClass("current")||(a=d(this).data("cat"),e.siblings().removeClass("current"),e.addClass("current"),s.find('input[name="cat"]').val(a),s.trigger("abslayer/EcosystemMap/Searching"))}),d(document.body).on("click","#btn-load-more-projects",function(e){e.preventDefault();var a=d(this);abslayer.Query.page<abslayer.Query.maxNumPages&&(u.addClass("updating-icon"),setTimeout(function(){abslayer.Query.page+=1,i(!0),u.removeClass("updating-icon"),abslayer.Query.page===abslayer.Query.maxNumPages&&a.hide()},700))}),r.on("scroll",function(){var e,a=d(this).scrollTop();t<a&&(e=r.height(),e=parseInt(.9*e),u.offset().top+u.outerHeight(!0)-e<=a)&&(u.hasClass("updating-icon")||u.trigger("click")),t=a})}(jQuery);